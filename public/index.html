<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BANK Dice Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <h1>BANK ðŸŽ²</h1>
      <p class="tagline">Race to bank the pot before it busts.</p>
    </header>

    <!-- LOBBY -->
    <section id="lobby" class="card">
      <h2>Join or Create a Game</h2>

      <div class="form-row">
        <label for="playerName">Your Name</label>
        <input id="playerName" type="text" placeholder="Enter your name" />
      </div>

      <div class="form-row">
        <span class="form-label">Mode</span>
        <div class="mode-toggle" role="radiogroup" aria-label="Game mode">
          <label class="toggle-option">
            <input type="radio" name="gameMode" value="single" />
            <span>Single Player</span>
          </label>
          <label class="toggle-option">
            <input type="radio" name="gameMode" value="multi" checked />
            <span>Multiplayer</span>
          </label>
        </div>
      </div>

      <div class="form-row" id="gameNameRow">
        <label for="gameName">Game Name</label>
        <input id="gameName" type="text" placeholder="FamilyNight, YouthGroup..." />
      </div>

      <div class="form-row">
        <label for="roundsSelect">Rounds</label>
        <select id="roundsSelect">
          <option value="10">10 Rounds</option>
          <option value="15">15 Rounds</option>
          <option value="20" selected>20 Rounds</option>
        </select>
      </div>

      <div class="form-row">
        <label for="intervalSelect">Seconds Between Rolls</label>
        <select id="intervalSelect">
          <option value="3">3 seconds</option>
          <option value="5" selected>5 seconds</option>
          <option value="7">7 seconds</option>
          <option value="10">10 seconds</option>
        </select>
      </div>

      <div class="button-row">
        <button id="createGameBtn" class="primary">Create Game</button>
        <button id="joinGameBtn" class="secondary">Join Existing Game</button>
      </div>

      <div class="button-row button-row-centered">
        <button id="howToPlayLobbyBtn" class="secondary">How to Play</button>
      </div>

      <p id="lobbyError" class="error-msg"></p>

      <div class="lobby-highscores">
        <div class="highscores-header">
          <h3>All-Time Top 5</h3>
          <span class="highscores-subtitle">Highest BANK scores</span>
        </div>
        <p id="highScoresEmpty" class="highscores-empty">No scores yet â€” finish a game to set the first record.</p>
        <ol id="highScoresList" class="highscores-list"></ol>
      </div>
    </section>

    <!-- GAME -->
    <section id="game" class="game-layout hidden">
      <div class="top-row">
        <div class="card pot-card" id="potCard">
          <div class="card-header">
            <span class="card-title">BANK Pot</span>
          </div>
          <div class="pot-value" id="potValue">0</div>
          <div class="phase-badge phase-safe" id="phaseBadge">Phase 1 Â· Safe Rolls</div>
        </div>

        <div class="card status-card">
          <div class="status-line">
            <span class="label">Game:</span>
            <span id="gameNameLabel"></span>
          </div>
          <div class="status-line">
            <span class="label">Round:</span>
            <span id="roundLabel">1</span>
            <span>/</span>
            <span id="totalRoundsLabel">20</span>
          </div>
          <div class="status-line">
            <span class="label">Phase:</span>
            <span id="phaseLabel">1</span>
          </div>
          <div class="status-line">
            <span class="label">Roll:</span>
            <span id="rollCounterLabel">â€”</span>
          </div>
          <div class="status-line">
            <span class="label">Next Roll In:</span>
            <span id="timerLabel">â€”</span>
          </div>
          <div class="status-line">
            <span class="label">Roller:</span>
            <span id="rollerLabel">â€”</span>
          </div>
        </div>

        <div class="card share-card">
          <div class="card-header">
            <span class="card-title">Share</span>
          </div>
          <p class="share-text">Invite everyone to this table fast.</p>
          <div class="share-actions">
            <button id="shareLinkBtn" class="secondary">Copy game link</button>
            <button id="shareQrBtn" class="secondary">Show QR</button>
          </div>
          <p id="shareStatus" class="share-status" aria-live="polite"></p>
        </div>
      </div>

      <div class="mid-row">
        <div class="card players-card">
          <div class="card-header">
            <span class="card-title">Players</span>
          </div>
          <div id="playersList" class="players-list"></div>
        </div>

        <div class="card dice-card">
          <div class="card-header">
            <span class="card-title">Dice</span>
          </div>
          <div class="dice-display">
            <div class="dice" id="dice1">â€“</div>
            <div class="dice" id="dice2">â€“</div>
          </div>
          <div class="roll-summary" id="rollSummary">Waiting for first rollâ€¦</div>
        </div>
      </div>

      <div class="bottom-row">
        <button id="startGameBtn" class="secondary hidden">Start Game</button>
        <button id="bankBtn" class="primary bank-btn">BANK IT</button>
        <button id="restartBtn" class="secondary hidden">New Game</button>
        <button id="endGameBtn" class="secondary hidden">End Game</button>
        <button id="howToPlayGameBtn" class="secondary">How to Play</button>
      </div>

      <div class="card voice-card">
        <div class="card-header">
          <span class="card-title">Voice Chat</span>
        </div>
        <div class="voice-controls">
          <button id="pushToTalkBtn" class="secondary push-to-talk floating-ptt" disabled>Mic Off</button>
          <button id="groupMuteBtn" class="secondary hidden">Mute Group</button>
          <div class="voice-status">
            <span id="voiceStatus">Join a game to enable voice chat.</span>
            <span id="voiceHint" class="voice-hint">Press Space or tap the button to toggle your mic.</span>
          </div>
        </div>
        <div id="remoteAudio" class="remote-audio"></div>
      </div>

      <p id="gameMessage" class="game-message"></p>
    </section>
  </div>

  <div id="qrModal" class="qr-modal hidden" role="dialog" aria-modal="true" aria-labelledby="qrTitle">
    <div class="qr-dialog card">
      <div class="card-header">
        <span class="card-title" id="qrTitle">Scan to Join</span>
        <button id="qrCloseBtn" class="secondary">Close</button>
      </div>
      <p class="share-text">Point your camera at the code to open the game link.</p>
      <img id="qrImage" class="qr-image" alt="QR code for the game link" />
      <p id="qrLinkLabel" class="share-status"></p>
    </div>
  </div>

  <div id="howToPlayModal" class="how-to-modal hidden" role="dialog" aria-modal="true" aria-labelledby="howToTitle">
    <div class="how-to-dialog card">
      <div class="card-header">
        <span class="card-title" id="howToTitle">How to Play</span>
        <button id="howToCloseBtn" class="secondary icon-button" aria-label="Close">âœ•</button>
      </div>
      <div class="how-to-content">
        <p>Rolls happen automatically. Bank anytime before a 7 shows in Phase 2.</p>
        <ul>
          <li><strong>Phase 1 (rolls 1-3):</strong> safe. 7 = 70 points, doubles add face value.</li>
          <li><strong>Phase 2 (roll 4+):</strong> danger. 7 wipes the pot, doubles double the pot.</li>
        </ul>
        <p>Highest total after the rounds wins.</p>
      </div>
    </div>
  </div>

  <!-- Audio -->
  <audio id="diceRollSound" src="dice-roll.mp3" preload="auto"></audio>
  <audio id="doubleSound" src="double.mp3" preload="auto"></audio>
  <audio id="bustSound" src="bust.mp3" preload="auto"></audio>
  <audio id="bankSound" src="bank.mp3" preload="auto"></audio>

  <script src="/socket.io/socket.io.js"></script>
  <script src="client.js"></script>
</body>
</html>
